; #### DO NOT EDIT THIS FILE ###################################################
; ## This file is managed by ansible. Local changes will be overwritten       ##
; ##############################################################################

[{{ php_fpm_pool }}]

; Unix user/group of processes

user = {{ php_user }}
{% if php_group != "" %}
group = {{ php_group }}
{% endif %}

listen = {{ php_socket_path }}/$pool.sock
listen.backlog = 511

; Set permissions for unix socket, if one is used
listen.owner = {{ php_user }}
{% if php_group != "" %}
listen.group = {{ php_group }}
{% endif %}
listen.mode = 0660
{% if php_allowed_clients != "" %}
listen.allowed_clients = {{ php_allowed_clients }}
{% endif %}

{% if php_niceness != "" %}
process.priority = {{ php_niceness }}
{% endif %}

pm = {{ php_pm }}
pm.max_children = {{ php_max_children }}
pm.start_servers = {{ php_start_servers }}
pm.min_spare_servers = {{ php_min_spare_servers }}
pm.max_spare_servers = {{ php_max_spare_servers }}
pm.process_idle_timeout = {{ php_process_idle_timeout }};
{% if php_max_requests != "" %}
pm.max_requests = {{ php_max_requests }}
{% endif %}

; The access log file
; Default: not set
;access.log = log/$pool.access.log

; The access log format.
;access.format = "%R - %u %t \"%m %r%Q%q\" %s %f %{mili}d %{kilo}M %C%%"

; The log file for slow requests
; Default Value: not set
; Note: slowlog is mandatory if request_slowlog_timeout is set
;slowlog = log/$pool.log.slow

; The timeout for serving a single request after which a PHP backtrace will be
; dumped to the 'slowlog' file. A value of '0s' means 'off'.
; Available units: s(econds)(default), m(inutes), h(ours), or d(ays)
; Default Value: 0
;request_slowlog_timeout = 0

; Depth of slow log stack trace.
; Default Value: 20
;request_slowlog_trace_depth = 20

; The timeout for serving a single request after which the worker process will
; be killed. This option should be used when the 'max_execution_time' ini option
; does not stop script execution for some reason. A value of '0' means 'off'.
; Available units: s(econds)(default), m(inutes), h(ours), or d(ays)
; Default Value: 0
;request_terminate_timeout = 0

; Set open file descriptor rlimit.
; Default Value: system defined value
rlimit_files = 1024

; Set max core size rlimit.
; Possible Values: 'unlimited' or an integer greater or equal to 0
; Default Value: system defined value
;rlimit_core = 0

{% if php_chroot != "" %}
chroot = {{ php_chroot }}
{% endif %}
{% if php_chdir != "" %}
chdir = {{php_chdir}}
{% endif %}

clear_env = yes
security.limit_extensions = {{ php_limit_extensions }}

; Pass environment variables like LD_LIBRARY_PATH. All $VARIABLEs are taken from
; the current environment.
; Default Value: clean env
env[PATH] = {{ php_env_PATH }}
env[TMP] = /tmp
env[TMPDIR] = /tmp
env[TEMP] = /tmp

; Additional php.ini defines, specific to this pool of workers. These settings
; overwrite the values previously defined in the php.ini. The directives are the
; same as the PHP SAPI:
php_admin_value[memory_limit] = {{php_memlimit}}
php_admin_value[post_max_size] = {{php_maxuploadsize}}
php_admin_value[upload_max_filesize] = {{php_maxuploadsize}}
